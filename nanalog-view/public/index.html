<html>

<head>
  <title>Nanalog</title>
    <!-- Standard Meta -->
    <meta charset="utf-8" />

    <link rel="stylesheet" href="http://fonts.googleapis.com/earlyaccess/jejugothic.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.2/semantic.min.css">
    <style type="text/css">
        body> .grid {
            height: 100%;
        }

        .column {
            max-width: 450px;
        }

        #login-form {
            position: relative;
            width: 375px;
            height: 535px;
            border-radius: 5px;
            box-shadow: 2px 4px 4px 0 rgba(193, 193, 193, 0.5);
            border: solid 1px #979797 !important;
        }

        .join-form {
            height: 750px;
        }

        .password-search-form {
            height: 440px;
        }

        #login-form-logo {
            margin-top: 55px;
            margin-bottom: 60px;
        }

        .login-form-component {
            margin-bottom: 30px !important;
            margin-left: 37px !important;
            margin-right: 37px !important;
            width: 300.4px !important;
            height: 49.3px !important;
            border-radius: 40px !important;
            border: solid 1px #c1c1c1 !important;
        }

        .login-form-bottom {
            position: absolute;
            bottom: 0px;
        }

        .login-form-btn {
            margin-top: 32px !important;
            width: 375px;
            height: 75px;
            border-radius: 5px;
            background-color: #969696 !important;
            border: solid 1px #5f5f5f !important;
        }

        .login-form-btn-text {
            margin-top: 20px;
            margin-left: 125px;
            width: 78.1px;
            height: 27px;
            font-family: NanumSquareOTFB;
            font-size: 25px;
            font-weight: 400;
            color: #ffffff;
        }

        #main-intro-header {
            width: 300px;
            height: 78px;
            margin-bottom: 10rem;
            font-family: NanumSquareOTFB;
            font-size: 70px;
            font-weight: 400;
            text-align: right;
            color: #c1c1c1;
        }

        #main-intro-body {
            margin-left: 42px;
            margin-top: 48px;
            width: 312px;
            height: 74px;
            font-family: NanumSquareOTFR;
            font-size: 20px;
            font-weight: 400;
            letter-spacing: 0.2px;
            color: #868686;
        }

        .main-intro-layer {
            width: 78px;
            font-family: YDIYGO130;
            font-size: 90px;
            font-weight: 400;
            text-align: right;
            color: #969696;
        }

        .margin-intro-bar {
            margin-top: 47px;
            margin-left: 40px;
            width: 68px !important;
            height: 3px !important;
            border: solid 5px #969696 !important;
        }

        .typed-cursor {
            display: none;
            opacity: 1;
            -webkit-animation: blink 0.7s infinite;
            -moz-animation: blink 0.7s infinite;
            animation: blink 0.7s infinite;
        }
    </style>
</head>

<body>
    <div class="ui">
        <div class="ui middle aligned stackable grid container">
            <div class="row">
                <div class="eight wide column">
                    <div class='main-intro-layer' style="margin-left:-4rem;margin-top:4rem;font-family: 'Jeju Gothic', sans-serif;">"</div>
                    <h1 id='main-intro-header' class="ui header">오늘 하루 어땠나요?</h1>
                    <div class='margin-intro-bar'></div>
                    <p id='main-intro-body'>나날로그는 당신의 기록을 남길 수 있는 공간을 제공하는 서비스입니다</p>
                    <div class='main-intro-layer' style="margin-left:22rem;margin-top:2rem;font-family: 'Jeju Gothic', sans-serif;">"</div>
                </div>
                <div class="six wide right floated column">
                    <div class="ui middle aligned center aligned grid">
                        <div class="column" style='margin-top:5rem'>
                            <div class="ui large form">
                                <div id='login-form'>
                                    <input type="image" id='login-form-logo' class="field" src="img/blackLogo.png"/>
                                    <div id='main-template'>
                                    </div>
                                    <div class='field login-form-bottom'>
                                        <p><a id='member-join' href="#" style='margin-right:17px; text-decoration: underline;'>회원가입</a> <a id='password-search' href="#" style="text-decoration: underline;">비밀번호 찾기</a></p>
                                        <div id='login-btn' class="ui teal submit button login-form-btn">
                                            <div id='login-btn-name' class='login-form-btn-text'>로그인</div>
                                        </div>

                                        <div id='join-btn' class="ui teal submit button login-form-btn" style='display:none'>
                                            <div id='join-btn-name' class='login-form-btn-text'>가입</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="ui error message"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.2/semantic.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/typed.js/1.1.4/typed.min.js"></script>
    <script>
        const serverUrl = 'http://localhost:8080/';

        var memberLoginTemplate = function() {
            let memberLoginTemplate = '';
            memberLoginTemplate += "<div class='field'>";
            memberLoginTemplate += "<input class='login-form-component' id = 'login-form-id' type='text' name='email' placeholder='아이디'>";
            memberLoginTemplate += "</div>";
            memberLoginTemplate += "<div class='field'>";
            memberLoginTemplate += "<input class='login-form-component' id = 'login-form-password' type='password' name='password' placeholder='비밀번호'>";
            memberLoginTemplate += "</div>";
            return memberLoginTemplate;
        }

        var memberJoinTemplate = function() {
            let memberJoinTemplate = '';
            memberJoinTemplate += "<div class='field'>"
            memberJoinTemplate += "<input class='login-form-component' id = 'login-form-nick'  type='text' name='nickname' placeholder='닉네임'>";
            memberJoinTemplate += "</div>";
            memberJoinTemplate += memberLoginTemplate();
            return memberJoinTemplate;
        }

        var passwordSearchTemplate = function() {
            let passwordSearchTemplate = '';
            passwordSearchTemplate += "<div class='field'>"
            passwordSearchTemplate += "<input class='login-form-component' type='text' name='nickname' placeholder='이메일 주소'>";
            passwordSearchTemplate += "</div>";
            return passwordSearchTemplate;
        }

        var loginButtonClickEventHandler = function() {
            $('#login-btn').click(function(e) {
                let uid = document.getElementById("login-form-id").value;
                let password = document.getElementById("login-form-password").value;

                $.post(serverUrl + 'v1/user/login', {
                        uid: uid,
                        password: password
                    },
                    function(data) {
                      console.log(data);
                        if (data.uid == '' || data.uid == null) {
                            alert("로그인 실패");
                        } else {
                            alert("로그인 성공");
                            location.href = './main.html#'+data.uid;
                            /*
                              메인페이지 분기
                            */
                        }
                    }).fail(function(e){
                      alert("로그인 서버 요청 실패");
                    });
            });
        }


        var passwordSearchButtonClickEventHandler = function() {
            let email = document.getElementById('login-form-email').value;
        }

        var joinButtonClickEventHandler = function() {
            $('#join-btn').click(function(e) {
                let uid = document.getElementById("login-form-id").value;
                let password = document.getElementById("login-form-password").value;
                let nick = document.getElementById('login-form-nick').value;


                $.post(serverUrl + 'v1/user', {
                        uid: uid,
                        name: nick,
                        password: password
                    },
                    function(data) {
                      alert("회원 가입 성공");
                      $('#login-form-logo').trigger('click');
                    }).fail(function(e){
                      alert("회원 가입 실패");
                    });
            });
        }

        $(document)
            .ready(function() {

                $("#main-intro-body").typed({
                    strings: ["나날로그는 당신의 기록을 남길 수 있는 공간을 제공하는 서비스입니다."],
                    typeSpeed: 150
                });

                $('#join-btn').css('display', 'none');
                $('#login-btn').css('display', 'block');
                $('#main-template').html(memberLoginTemplate());

                $('#login-form-logo').click(function(e) {
                  $('#member-login').css('display', 'none');
                  $('#member-join').css('display', 'inline-block');
                                      $('#password-search').css('display', 'inline-block');
                  $('#join-btn').css('display', 'none');
                  $('#login-btn').css('display', 'inline-block');
                  $('#main-template').html(memberLoginTemplate());
                });

                loginButtonClickEventHandler();

                $('#member-join').click(function(e) {
                    $('#member-login').css('display', 'inline-block');
                    $('#member-join').css('display', 'none');
                    $('#password-search').css('display', 'none');
                    $('#login-btn').css('display', 'none');
                    $('#join-btn').css('display', 'inline-block');
                    $('#main-template').html(memberJoinTemplate());
                });

                joinButtonClickEventHandler();
            });
    </script>
</body>

</html>
